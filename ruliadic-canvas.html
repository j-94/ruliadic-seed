<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruliadic Canvas - Universal Interface Bootstrap</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: white;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .seed-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .container {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .panel-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
        }

        .metric {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .label {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .evolution-timeline {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .evolution-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.75rem;
            border-radius: 8px;
            border-left: 4px solid #4ecdc4;
        }

        .environment-info {
            background: rgba(0, 0, 0, 0.2);
            padding: 1rem;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.85rem;
            margin: 1rem 0;
        }

        .canvas-area {
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 2rem;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .canvas-placeholder {
            opacity: 0.7;
        }

        .generated-canvas {
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            overflow-y: auto;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        }

        .btn-secondary {
            background: rgba(59, 130, 246, 0.5);
        }

        .btn-success {
            background: linear-gradient(45deg, #10b981, #059669);
        }

        .output-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: monospace;
            font-size: 0.85rem;
            max-height: 200px;
            overflow-y: auto;
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .feature-tag {
            background: rgba(78, 205, 196, 0.2);
            padding: 0.25rem 0.5rem;
            border-radius: 20px;
            font-size: 0.75rem;
            text-align: center;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <div class="seed-icon">🌱</div>
            <div>
                <h1>Ruliadic Canvas Generator</h1>
                <p>Universal Interface Bootstrap & Environment Adaptation</p>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="panel">
            <div class="panel-title">
                <span>🔬</span>
                <span>Environment Analysis</span>
            </div>

            <div class="status-grid">
                <div class="status-card">
                    <div class="metric" id="env-type">Detecting...</div>
                    <div class="label">Environment</div>
                </div>
                <div class="status-card">
                    <div class="metric" id="capabilities-count">0</div>
                    <div class="label">Capabilities</div>
                </div>
                <div class="status-card">
                    <div class="metric" id="evolution-stage">Seed</div>
                    <div class="label">Evolution Stage</div>
                </div>
                <div class="status-card">
                    <div class="metric" id="adaptability">Calculating...</div>
                    <div class="label">Adaptability</div>
                </div>
            </div>

            <div class="environment-info" id="environment-info">
                <strong>Environment Details:</strong><br>
                Detecting environment characteristics...
            </div>

            <div class="evolution-timeline" id="evolution-timeline">
                <div class="evolution-item">
                    <strong>Seed Initialized</strong><br>
                    <small>Core ruliadic capabilities activated</small>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-title">
                <span>🎨</span>
                <span>Ruliadic Canvas</span>
            </div>

            <div class="canvas-area">
                <div class="canvas-placeholder" id="canvas-placeholder">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">🎲</div>
                    <h3>Empty Canvas</h3>
                    <p>Generate a ruliadic interface adapted to any environment</p>
                </div>
                <div class="generated-canvas" id="generated-canvas" style="display: none;">
                    <div id="canvas-content"></div>
                </div>
            </div>

            <div class="feature-list" id="feature-list">
                <!-- Features will be populated here -->
            </div>

            <div class="control-panel">
                <button class="btn btn-primary" onclick="generateCanvas()">
                    🎨 Generate Canvas
                </button>
                <button class="btn btn-secondary" onclick="evolveSystem()">
                    🌱 Evolve System
                </button>
                <button class="btn btn-success" onclick="testCapabilities()">
                    🔬 Test Capabilities
                </button>
                <button class="btn" onclick="exportCanvas()">
                    📤 Export Canvas
                </button>
            </div>

            <div class="output-area" id="output-area">
                <strong>System Output:</strong><br>
                Ready for ruliadic generation...
            </div>
        </div>
    </div>

    <!-- Load the Ruliadic Seed -->
    <script src="ruliadic-seed.js"></script>

    <script>
        let ruliadicSeed = null;
        let canvasData = null;

        // Initialize the system
        document.addEventListener('DOMContentLoaded', () => {
            initializeSystem();
        });

        function initializeSystem() {
            try {
                // Initialize the ruliadic seed
                if (typeof RuliadicSeed !== 'undefined') {
                    ruliadicSeed = RuliadicSeed.init();
                    updateDisplay();
                } else {
                    // Load seed if not already loaded
                    const script = document.createElement('script');
                    script.src = 'ruliadic-seed.js';
                    script.onload = () => {
                        ruliadicSeed = RuliadicSeed.init();
                        updateDisplay();
                    };
                    document.head.appendChild(script);
                }
            } catch (error) {
                console.error('Failed to initialize ruliadic seed:', error);
                document.getElementById('output-area').innerHTML =
                    `<strong>Error:</strong><br>${error.message}`;
            }
        }

        function updateDisplay() {
            if (!ruliadicSeed) return;

            const status = ruliadicSeed.getStatus();

            // Update environment info
            document.getElementById('env-type').textContent = status.environment.type;
            document.getElementById('capabilities-count').textContent = Object.keys(status.capabilities).length;
            document.getElementById('evolution-stage').textContent = status.state;
            document.getElementById('adaptability').textContent = status.self.adaptability.rating;

            // Update environment details
            const envInfo = document.getElementById('environment-info');
            envInfo.innerHTML = `
                <strong>Environment Details:</strong><br>
                Type: ${status.environment.type}<br>
                Platform: ${status.environment.platform}<br>
                Browser: ${status.environment.isBrowser ? 'Yes' : 'No'}<br>
                Node.js: ${status.environment.isNode ? 'Yes' : 'No'}<br>
                React: ${status.environment.hasReact ? 'Yes' : 'No'}<br>
                Adaptability: ${status.self.adaptability.rating}
            `;

            // Update evolution timeline
            updateEvolutionTimeline(status.evolution);

            // Update feature list
            updateFeatureList(status.capabilities);
        }

        function updateEvolutionTimeline(evolution) {
            const timeline = document.getElementById('evolution-timeline');

            evolution.forEach((event, index) => {
                if (index === 0) return; // Skip initial seed

                const item = document.createElement('div');
                item.className = 'evolution-item';
                item.innerHTML = `
                    <strong>${event.event}</strong><br>
                    <small>${new Date(event.timestamp).toLocaleTimeString()}</small>
                `;
                timeline.appendChild(item);
            });
        }

        function updateFeatureList(capabilities) {
            const featureList = document.getElementById('feature-list');
            featureList.innerHTML = '';

            Object.keys(capabilities).forEach(cap => {
                const tag = document.createElement('div');
                tag.className = 'feature-tag';
                tag.textContent = cap;
                featureList.appendChild(tag);
            });
        }

        function generateCanvas() {
            if (!ruliadicSeed) {
                alert('Ruliadic seed not initialized yet!');
                return;
            }

            try {
                // Generate ruliadic canvas
                canvasData = ruliadicSeed.generateCanvas({
                    includeBrowserFeatures: ruliadicSeed.environment.isBrowser,
                    includeNodeFeatures: ruliadicSeed.environment.isNode,
                    theme: 'auto',
                    complexity: 'medium'
                });

                // Display canvas
                displayCanvas(canvasData);

                // Update output
                document.getElementById('output-area').innerHTML = `
                    <strong>Canvas Generated:</strong><br>
                    Type: ${canvasData.type}<br>
                    Environment: ${canvasData.environment}<br>
                    Features: ${canvasData.features.length}<br>
                    Evolution: ${canvasData.evolution_stage}<br>
                    <pre>${JSON.stringify(canvasData.baked_features, null, 2)}</pre>
                `;

            } catch (error) {
                document.getElementById('output-area').innerHTML =
                    `<strong>Error:</strong><br>${error.message}`;
            }
        }

        function displayCanvas(canvasData) {
            const placeholder = document.getElementById('canvas-placeholder');
            const canvas = document.getElementById('generated-canvas');
            const content = document.getElementById('canvas-content');

            // Hide placeholder, show canvas
            placeholder.style.display = 'none';
            canvas.style.display = 'block';

            // Generate canvas content based on environment
            let canvasHTML = `
                <h3>🎨 Ruliadic Canvas</h3>
                <p><strong>Environment:</strong> ${canvasData.environment}</p>
                <p><strong>Evolution Stage:</strong> ${canvasData.evolution_stage}</p>
                <p><strong>Generated:</strong> ${new Date(canvasData.generated_at).toLocaleString()}</p>
            `;

            // Add environment-specific content
            if (canvasData.environment === 'browser') {
                canvasHTML += `
                    <h4>🌐 Browser Capabilities</h4>
                    <div style="border: 1px solid rgba(255,255,255,0.3); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                        <p>✅ DOM Manipulation</p>
                        <p>✅ Network Requests</p>
                        <p>✅ Local Storage</p>
                        <p>✅ Real-time Updates</p>
                    </div>
                    <button onclick="testDOM()">Test DOM Manipulation</button>
                    <button onclick="testNetwork()">Test Network</button>
                `;
            } else if (canvasData.environment === 'nodejs') {
                canvasHTML += `
                    <h4>🖥️ Node.js Capabilities</h4>
                    <div style="border: 1px solid rgba(255,255,255,0.3); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                        <p>✅ File System Access</p>
                        <p>✅ Process Management</p>
                        <p>✅ Module System</p>
                        <p>✅ Server Operations</p>
                    </div>
                    <button onclick="testFileSystem()">Test File System</button>
                    <button onclick="testProcess()">Test Process</button>
                `;
            }

            // Add feature tags
            canvasHTML += '<h4>🔧 Baked-in Features</h4>';
            canvasHTML += '<div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 1rem 0;">';

            Object.keys(canvasData.baked_features).forEach(feature => {
                canvasHTML += `<span style="background: rgba(78, 205, 196, 0.3); padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">${feature}</span>`;
            });

            canvasHTML += '</div>';

            content.innerHTML = canvasHTML;
        }

        function evolveSystem() {
            if (!ruliadicSeed) return;

            try {
                ruliadicSeed.grow();
                updateDisplay();

                document.getElementById('output-area').innerHTML = `
                    <strong>System Evolution:</strong><br>
                    New Stage: ${ruliadicSeed.state}<br>
                    Evolution Event: ${ruliadicSeed.evolution[ruliadicSeed.evolution.length - 1]?.event}<br>
                    Timestamp: ${new Date().toLocaleTimeString()}
                `;

                // Show evolution message
                setTimeout(() => {
                    alert(`🌱 System evolved to: ${ruliadicSeed.state} stage!`);
                }, 500);

            } catch (error) {
                document.getElementById('output-area').innerHTML =
                    `<strong>Evolution Error:</strong><br>${error.message}`;
            }
        }

        function testCapabilities() {
            if (!ruliadicSeed) return;

            const testResults = [];

            // Test chat capability
            try {
                const chatResult = ruliadicSeed.chat('test message');
                testResults.push(`💬 Chat: ✅ ${chatResult.response.substring(0, 50)}...`);
            } catch (e) {
                testResults.push(`💬 Chat: ❌ ${e.message}`);
            }

            // Test generation capability
            try {
                const genResult = ruliadicSeed.generateCanvas();
                testResults.push(`🎨 Generation: ✅ Canvas created`);
            } catch (e) {
                testResults.push(`🎨 Generation: ❌ ${e.message}`);
            }

            // Test improvement capability
            try {
                const impResult = ruliadicSeed.processImprovement('test_target');
                testResults.push(`📈 Improvement: ✅ ${impResult.results.status}`);
            } catch (e) {
                testResults.push(`📈 Improvement: ❌ ${e.message}`);
            }

            document.getElementById('output-area').innerHTML = `
                <strong>Capability Test Results:</strong><br>
                ${testResults.join('<br>')}
            `;
        }

        function exportCanvas() {
            if (!canvasData) {
                alert('No canvas generated yet! Click "Generate Canvas" first.');
                return;
            }

            const exportData = {
                canvas: canvasData,
                export_timestamp: new Date().toISOString(),
                environment: ruliadicSeed.environment.type,
                seed_version: ruliadicSeed.version
            };

            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ruliadic-canvas-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Test functions for canvas interaction
        function testDOM() {
            const canvas = document.getElementById('canvas-content');
            const testDiv = document.createElement('div');
            testDiv.style.background = 'rgba(255, 107, 107, 0.3)';
            testDiv.style.padding = '1rem';
            testDiv.style.borderRadius = '8px';
            testDiv.style.margin = '1rem 0';
            testDiv.innerHTML = `
                <h4>✅ DOM Manipulation Test</h4>
                <p>Successfully modified the canvas!</p>
                <p>Timestamp: ${new Date().toLocaleTimeString()}</p>
            `;
            canvas.appendChild(testDiv);

            // Update output
            document.getElementById('output-area').innerHTML = `
                <strong>DOM Test:</strong><br>
                ✅ Successfully manipulated DOM<br>
                ✅ Added dynamic content<br>
                ✅ Applied styling
            `;
        }

        function testNetwork() {
            fetch('/health')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('output-area').innerHTML = `
                        <strong>Network Test:</strong><br>
                        ✅ HTTP request successful<br>
                        ✅ Response: ${data.status}<br>
                        ✅ Server uptime: ${data.uptime}
                    `;
                })
                .catch(error => {
                    document.getElementById('output-area').innerHTML = `
                        <strong>Network Test:</strong><br>
                        ❌ ${error.message}
                    `;
                });
        }

        function testFileSystem() {
            document.getElementById('output-area').innerHTML = `
                <strong>File System Test:</strong><br>
                ✅ Node.js environment detected<br>
                ✅ File system access available<br>
                ℹ️ Use Node.js API for file operations
            `;
        }

        function testProcess() {
            document.getElementById('output-area').innerHTML = `
                <strong>Process Test:</strong><br>
                ✅ Node.js process management<br>
                ✅ Environment variables: ${Object.keys(process.env).length} available<br>
                ✅ Process execution capabilities
            `;
        }

        // Auto-update every 5 seconds
        setInterval(() => {
            if (ruliadicSeed) {
                updateDisplay();
            }
        }, 5000);
    </script>
</body>
</html>